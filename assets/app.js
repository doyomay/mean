angular.module("app",["ngRoute"]),angular.module("app").controller("ApplicationCtrl",["$scope","UserSvc",function(o,t){o.$on("login",function(t,e){o.currentUser=e}),o.logout=function(){t.logout().then(function(t){console.log(t),o.currentUser=null})}}]),angular.module("app").controller("LoginCtrl",["$scope","UserSvc",function(o,t){o.login=function(e,n){t.login(e,n).then(function(t){console.log(t),o.$emit("login",t.data)})}}]),angular.module("app").controller("PostsCtrl",["$scope","PostsSvc",function(o,t){o.addPost=function(){o.postBody&&t.create({username:"doyomay",body:o.postBody}).success(function(t){o.posts.unshift(t),o.postBody=null})},t.fetch().success(function(t){o.posts=t})}]),angular.module("app").service("PostsSvc",["$http",function(o){this.fetch=function(){return o.get("/api/posts")},this.create=function(t){return o.post("/api/posts",t)}}]),angular.module("app").controller("RegisterCtrl",["$scope","UserSvc",function(o,t){o.createUser=function(o,e){t.createUser(o,e).then(function(o){console.log(o)})}}]),angular.module("app").config(["$routeProvider","$locationProvider",function(o,t){t.html5Mode({enabled:!0,requireBase:!1}),o.when("/",{controller:"PostsCtrl",templateUrl:"posts.html"}).when("/register",{controller:"RegisterCtrl",templateUrl:"register.html"}).when("/login",{controller:"LoginCtrl",templateUrl:"login.html"})}]),angular.module("app").service("UserSvc",["$http",function(o){var t=this;t.getUser=function(){return o.get("/api/users")},t.login=function(e,n){return o.post("/api/sessions",{username:e,password:n}).then(function(e){return t.token=e.data,o.defaults.headers.common["X-Auth"]=e.data,t.getUser()})},t.createUser=function(t,e){return o.post("/api/users",{username:t,password:e}).then(function(o){console.log(o)})},t.logout=function(){return o.get("api/users/logout").then(function(o){console.log(o)})}}]);